<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no" /> -->
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=CKEA2iWwoiSyObLF9lQhkNdb8SzcvBPi"></script>
    <script type="text/javascript" src="//api.map.baidu.com/library/Heatmap/2.0/src/Heatmap_min.js"></script>
	<title>地图展示</title>
	<style type="text/css">
	body, html{width: 100%;height: 100%;overflow: hidden;margin:0;font-family:"微软雅黑";}
	#container{height:1600px;width:100%;}
	#r-result{width:100%;}
	</style>
</head>
<body>
	<div id="container"></div>
	<div id="r-result">
			<input type="button"  onclick="openHeatmap();" value="显示热力图"/>
			<input type="button"  onclick="closeHeatmap();" value="关闭热力图"/>
		</div>
</body>
</html>
<script type="text/javascript">
    var map = new BMap.Map("container");     // 初始化地图,设置中心点坐标和地图级别（）
    map.setCurrentCity("哈尔滨");          // 设置地图显示的城市 此项是必须设置的
    var navigationControl = new BMap.NavigationControl();//创建平移缩放控件 
	var scaleControl = new BMap.ScaleControl();//这里创建比例尺控件  
	    map.addControl(scaleControl);
      //添加到地图
	var point = new BMap.Point(126.625,45.7404999);
	    map.centerAndZoom(point, 13);             // 初始化地图，设置中心点坐标和地图级别
	    map.enableScrollWheelZoom(true); // 允许滚轮缩放
	  
	    var points =[
{"lng":126.62861,"lat":45.75778,"count":45},

{"lng":126.699722,"lat":45.634722,"count":5},
{"lng":127.243888,"lat":45.375833,"count":5},
{"lng":126.866111,"lat":45.870833,"count":5},
{"lng":126.43108,"lat":45.42536,"count":5},
{"lng":126.289444,"lat":45.311111,"count":5},
{"lng":126.4226,"lat":45.57055,"count":5},
{"lng":126.585833,"lat":45.705,"count":5},
{"lng":126.66508,"lat":45.74356,"count":5},
{"lng":126.61842,"lat":45.71711,"count":5},
{"lng":126.63553,"lat":45.77146,"count":5},
{"lng":126.599166,"lat":45.764166,"count":5},
{"lng":126.548611,"lat":45.711666,"count":5},
{"lng":126.7675,"lat":45.786388,"count":5},
{"lng":126.980177,"lat":45.539466,"count":5},
{"lng":126.549444,"lat":45.676944,"count":5},
{"lng":126.4675,"lat":45.594722,"count":5},
{"lng":127.015555,"lat":45.777777,"count":5},
{"lng":126.299722,"lat":45.499166,"count":5},
{"lng":126.63645,"lat":45.56934,"count":5},
{"lng":126.58442,"lat":45.75199,"count":5},
{"lng":126.298273,"lat":45.371699,"count":5},
{"lng":126.54948,"lat":45.49947,"count":5},
{"lng":126.998611,"lat":45.773055,"count":5},
{"lng":126.717777,"lat":45.722222,"count":5},
{"lng":126.622777,"lat":45.683611,"count":5},
{"lng":126.60181,"lat":45.68885,"count":5},
{"lng":126.67817,"lat":45.75897,"count":5},
{"lng":126.61792,"lat":45.73229,"count":5},
{"lng":126.689444,"lat":45.738333,"count":5},
{"lng":126.664722,"lat":45.716666,"count":5},
{"lng":126.972777,"lat":45.5275,"count":5},
{"lng":126.9725,"lat":45.5275,"count":5},
{"lng":126.563055,"lat":45.737222,"count":5},
{"lng":126.636388,"lat":45.743611,"count":5},
{"lng":126.649444,"lat":45.765833,"count":5},
{"lng":126.634166,"lat":45.776111,"count":5},
{"lng":126.765833,"lat":45.786666,"count":5},
{"lng":126.651111,"lat":45.751944,"count":5},
{"lng":126.66629,"lat":45.74497,"count":5},
{"lng":126.61303,"lat":45.72441,"count":5},
{"lng":126.642222,"lat":45.759166,"count":5},
{"lng":126.654,"lat":45.7492,"count":5},
{"lng":126.59854,"lat":45.76148,"count":5},
{"lng":126.96862,"lat":45.52851,"count":5},
{"lng":126.64724,"lat":45.77399,"count":5},
{"lng":126.293888,"lat":45.372777,"count":5},
{"lng":126.69769,"lat":45.72157,"count":5},
{"lng":126.652222,"lat":45.580555,"count":5},
{"lng":126.653,"lat":45.72243,"count":5},
{"lng":126.96742,"lat":45.54286,"count":5},
{"lng":126.59476,"lat":45.74817,"count":5},
{"lng":126.59325,"lat":45.71237,"count":5},
{"lng":126.5135,"lat":45.71419,"count":5},
{"lng":126.51935,"lat":45.71542,"count":5},
{"lng":126.95106,"lat":45.5488,"count":5},
{"lng":126.69062,"lat":45.78334,"count":5},
{"lng":126.5236,"lat":45.71623,"count":5},
{"lng":126.525,"lat":45.736111,"count":5},
{"lng":126.68571,"lat":45.72315,"count":5},
{"lng":126.650555,"lat":45.734166,"count":5},
{"lng":126.528888,"lat":45.724166,"count":5},
{"lng":126.720277,"lat":45.773333,"count":5},
{"lng":126.59171,"lat":45.68844,"count":5},
{"lng":126.635277,"lat":45.738055,"count":5},
{"lng":126.709722,"lat":45.742777,"count":5},
{"lng":126.493888,"lat":45.718055,"count":5},
{"lng":126.493888,"lat":45.718055,"count":5},
{"lng":126.4975,"lat":45.718888,"count":5},
{"lng":126.69766,"lat":45.78642,"count":5},
{"lng":126.776388,"lat":45.784166,"count":5},
{"lng":126.654722,"lat":45.579722,"count":5},
{"lng":126.655,"lat":45.5775,"count":5},
{"lng":126.583333,"lat":45.685833,"count":5},
{"lng":126.65933,"lat":45.73603,"count":5},
{"lng":126.63496,"lat":45.68882,"count":5},
{"lng":126.6882,"lat":45.72357,"count":5},
{"lng":126.625555,"lat":45.681111,"count":5},
{"lng":126.625555,"lat":45.681111,"count":5},
{"lng":126.571111,"lat":45.684722,"count":5},
{"lng":126.69758,"lat":45.76805,"count":5},
{"lng":126.60995,"lat":45.66761,"count":5},
{"lng":126.67762,"lat":45.73323,"count":5},
{"lng":126.66841,"lat":45.73572,"count":5},
{"lng":126.64708,"lat":45.72052,"count":5},
{"lng":126.65716,"lat":45.73682,"count":5},
{"lng":126.659722,"lat":45.7925,"count":5},
{"lng":126.591388,"lat":45.743055,"count":5},
{"lng":126.5642,"lat":45.72833,"count":5},
{"lng":126.68862,"lat":45.67699,"count":5},
{"lng":126.68862,"lat":45.67699,"count":5},
{"lng":125.98382,"lat":46.08367,"count":5},
{"lng":126.78487,"lat":45.71899,"count":5},
{"lng":126.65902,"lat":45.68862,"count":5},
{"lng":126.64436,"lat":45.78436,"count":5},
{"lng":126.65361,"lat":45.74694,"count":5},
{"lng":126.64914,"lat":45.71036,"count":5},
{"lng":126.590555,"lat":45.745,"count":5},
{"lng":126.60989,"lat":45.51967,"count":5},
{"lng":126.703888,"lat":45.731944,"count":5},
{"lng":126.69564,"lat":45.67768,"count":5},
{"lng":126.667182,"lat":45.689055,"count":5},
{"lng":126.69525,"lat":45.794,"count":5},
{"lng":126.669166,"lat":45.763611,"count":5},
{"lng":126.69382,"lat":45.77288,"count":5},
{"lng":126.56407,"lat":45.7249,"count":5},
{"lng":126.667222,"lat":45.693888,"count":5},
{"lng":126.70615,"lat":45.74079,"count":5},
{"lng":126.70615,"lat":45.74079,"count":5},
{"lng":126.654843,"lat":45.699649,"count":5},
{"lng":126.96057,"lat":45.54112,"count":5},
{"lng":126.60066,"lat":45.75387,"count":5},
{"lng":126.697777,"lat":45.733333,"count":5},
{"lng":126.589444,"lat":45.703888,"count":5},
{"lng":126.64487,"lat":45.60139,"count":5},
{"lng":126.662222,"lat":45.688888,"count":5},
{"lng":126.656111,"lat":45.685833,"count":5},
{"lng":126.656388,"lat":45.685555,"count":5},
{"lng":126.53775,"lat":45.72123,"count":5},
{"lng":126.53775,"lat":45.72123,"count":5},
{"lng":126.835555,"lat":45.786388,"count":5},
{"lng":126.623888,"lat":45.748611,"count":5},
{"lng":126.64422,"lat":45.60262,"count":5},
{"lng":126.654444,"lat":45.683888,"count":5},
{"lng":126.6514,"lat":45.7239,"count":5},
{"lng":126.705,"lat":45.786388,"count":5},
{"lng":126.306156,"lat":45.363558,"count":5},
{"lng":126.604444,"lat":45.775833,"count":5},
{"lng":126.676666,"lat":45.749722,"count":5},
{"lng":126.64677,"lat":45.75083,"count":5},
{"lng":126.64296,"lat":45.7499,"count":5},
{"lng":126.619166,"lat":45.733333,"count":5},
{"lng":126.631388,"lat":45.733055,"count":5},
{"lng":126.684166,"lat":45.712777,"count":5},
{"lng":126.600277,"lat":45.717777,"count":5},
{"lng":126.631388,"lat":45.733055,"count":5},
{"lng":126.619166,"lat":45.733333,"count":5},
{"lng":126.59873,"lat":45.75203,"count":5},
{"lng":126.6409,"lat":45.75663,"count":5},
{"lng":126.609166,"lat":45.746111,"count":5},
{"lng":126.558611,"lat":45.718611,"count":5},
{"lng":126.62445,"lat":45.75619,"count":5},
{"lng":126.62812,"lat":45.76566,"count":5},
{"lng":126.62898,"lat":45.69637,"count":5},
{"lng":126.619444,"lat":45.781388,"count":5},
{"lng":126.61349,"lat":45.77531,"count":5},
{"lng":126.61395,"lat":45.77553,"count":5},
{"lng":126.2969,"lat":45.370087,"count":5},
{"lng":126.544722,"lat":45.7325,"count":5},
{"lng":126.581944,"lat":45.744166,"count":5},
{"lng":126.757222,"lat":45.712222,"count":5},
{"lng":126.677777,"lat":45.731666,"count":5},
{"lng":126.5875,"lat":45.752777,"count":5},
{"lng":126.59927,"lat":45.75886,"count":5},
{"lng":126.595027,"lat":45.753371,"count":5},
{"lng":126.584444,"lat":45.755277,"count":5},
{"lng":126.58384,"lat":45.75265,"count":5},
{"lng":126.59031,"lat":45.75269,"count":5},
{"lng":126.591111,"lat":45.764722,"count":5},
{"lng":126.580533,"lat":45.754194,"count":5},
{"lng":126.59357,"lat":45.75433,"count":5},
{"lng":126.58522,"lat":45.756944,"count":5},
{"lng":126.593611,"lat":45.756666,"count":5},
{"lng":126.593611,"lat":45.756666,"count":5},
{"lng":126.593611,"lat":45.756666,"count":5},
{"lng":126.593333,"lat":45.756666,"count":5},
{"lng":126.59458,"lat":45.76422,"count":5},
{"lng":126.674742,"lat":45.69772,"count":5},
{"lng":126.699166,"lat":45.746666,"count":5},
{"lng":126.646666,"lat":45.763611,"count":5},
];
	   if(!isSupportCanvas()){
	        	alert('热力图目前只支持有canvas支持的浏览器,您所使用的浏览器不能使用热力图功能~')
	        }
	    	//详细的参数,可以查看heatmap.js的文档 https://github.com/pa7/heatmap.js/blob/master/README.md
	    	//参数说明如下:
	    	/* visible 热力图是否显示,默认为true
	         * opacity 热力的透明度,1-100
	         * radius 势力图的每个点的半径大小   
	         * gradient  {JSON} 热力图的渐变区间 . gradient如下所示
	         *	{
	    			.2:'rgb(0, 255, 255)',
	    			.5:'rgb(0, 110, 255)',
	    			.8:'rgb(100, 0, 255)'
	    		}
	    		其中 key 表示插值的位置, 0~1. 
	    		    value 为颜色值. 
	         */
	    heatmapOverlay = new BMapLib.HeatmapOverlay({"radius":30,"maxOpacity": .5});
	    map.addOverlay(heatmapOverlay);
	    heatmapOverlay.setDataSet({data:points,max:50});
			//是否显示热力图
		function openHeatmap(){
			heatmapOverlay.show();
		}
		function closeHeatmap(){
			heatmapOverlay.hide();
		}
		closeHeatmap();
		function setGradient(){
			     	/*格式如下所示:
					{
				  		0:'rgb(102, 255, 0)',
				 	 	.5:'rgb(255, 170, 0)',
					  	1:'rgb(255, 0, 0)'
					}*/
			var gradient = {};
			var colors = document.querySelectorAll("input[type='color']");
			    colors = [].slice.call(colors,0);
			    colors.forEach(function(ele){
					gradient[ele.getAttribute("data-key")] = ele.value; 
			    });
			    heatmapOverlay.setOptions({"gradient":gradient});
		}
				//判断浏览区是否支持canvas
		function isSupportCanvas(){
			var elem = document.createElement('canvas');
			return !!(elem.getContext && elem.getContext('2d'));
		}
</script>
